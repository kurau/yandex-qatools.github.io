#...или жизненный уклад и основные обычаи автоматизатора 21го века (с примерами).

## JUnit
С фрэймворком модульного тестирования http://junit.org/, кажется, знакомы все. 
Как видно из его описания, он направлен на создание "повторяемых" (repeatable) тестов. Что это значит?
Значит тесты, кторые мы написали, придётся ещё и поддерживать.
Поэтому в основную очередь стоит рассматривать данный инструмент как набор удобных механизмов, 
которые направлены на то, чтобы облегчить написание и дальнейшую поддержку наших тестов.
В данной статье мы остановимся подробней на механизме правил (Rules). 

## Фикстуры
Фикстура (Fixture) — состояние среды тестирования, которое требуется для 
успешного выполнения тестового метода, то есть особое состояние данных необходимое для успешного выполнения. Для создания фикстур уровня метода используются специальные аннотации @Before и @After (JUnit 4 в отличие от JUnit 3 полностью построен на аннотациях), которые указывают какие методы будут выполняться до основной логики теста и после него.
Такой подход к написанию тестов делает их, во-первых, интуитивно понятными (так как мы можем отделить логику теста от остальных служебных действий), во-вторых, даёт возможность переиспользовать уже написанные модули.
Вот пример такого деления:
* Before: создание необходимых данных; обеспечивание доступа к ресурсам (например DB);
* Test: действия, необходимые для получения результата; проверка, что нужный результат достигнут;
* After: очищение данных; освбождение занятых ресурсов;
Отметим, что в тестовом классе может быть несколько методов с аннотациями @Before и @After.
Выглядит это следующим образом: 

{% highlight java %}

public class SimpleTest {

    @Before
    public void before() {
        System.out.println("before");
    }
    
    @Before
    public void secondBefore() {
        System.out.println("before2");
    }
     
    @After
    public void after() {
        System.out.println("after");
    }
    
    @After
    public void secondAfter() {
        System.out.println("after2");
    }
     
    @Test
    public void test() {
        System.out.println("test");
    }
}

{% endhighlight %}

При выполнении этого класса мы получим такой вывод

>before
>before2
>test
>after
>after2

или такой

>before2
>before
>test
>after
>after2

Происходит это потому, что разные методы с одной аннтацией будут выполнятся в произвольном порядке. 
Также важно заметить, что метод с аннотацией @After будет выполняться всегда, вне зависимости от того, как прошёл тест (хорошо или плохо). С этой точки зрения исполнение получается строго линейным. 

##Rules
Правила в JUnit позволяют добавить намного больше событий чем просто "до" и "после", что позволяет сделать логику теста более гибкой, а также переопределить поведенеие каждого теста в тестовом классе.
Рула представляет из себя поле любого типа, реализующего интерфейс TestRule и помеченная аннотацией @Rule.

{% highlight java %}

public class SimpleTest {
    
    @Rule
    public TemporaryFolder tempFolder = new TemporaryFolder();

    @Test
    public void test() {
        System.out.println("test");
    }
}

{% endhighlight %}

JUnit предлагает использовать или расширять уже реализованные рулы, либо создавать новые.

Какие существуют?
Как сдлать самому? (TestRule, TestWatcher)
### TemporaryFolder Rule
Позволяет создавать файлы и папки которые гарантированно удалятся посл выполнения теста
### ExternalResource Rules
### ErrorCollector Rule
### Verifier Rule
### TestWatchman/TestWatcher Rules
